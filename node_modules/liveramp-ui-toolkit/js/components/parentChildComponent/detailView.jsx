const DetailView = React.createClass({
  componentDidMount() {
    this.props.fetchModel(this.props.model.id);
  },

  componentWillReceiveProps(nextProps) {
    if (nextProps.model.id !== this.props.model.id) {
      this.props.fetchModel(nextProps.model.id);
    }
  },

  render() {
    return (
      <div className="panel card offline">
        <div className="header">
          <div className="pull-right">
            <i className="fa fa-remove close-modal" onClick={this.props.closeDetailView} />
          </div>
          <h1>
            {this.props.title}
          </h1>
        </div>
        {this.getDetailViewBody()}
      </div>
    );
  },

  getDetailViewBody() {
    if (this.props.model.isFetching !== false) {
      return (
        <div className="body panel-fetching">
          Loading data...
        </div>
      );
    } else if (this.props.model.errorFetching) {
      return (
        <div className="body panel-fetching">
          There was an error fetching your data. Please try again or contact your LiveRamp representative for assistance.
        </div>
      );
    } else {
      return (
        <div className="body">
          {
            _.map(this.props.childComponents, (ChildComponent, i) => {
              return (
                <div key={i} className="panel-child">
                  <ChildComponent model={this.props.model} />
                </div>
              );
            })
          }
        </div>
      );
    }
  }
});

export default DetailView;
